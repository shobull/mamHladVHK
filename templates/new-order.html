<h1>Nová objednávka</h1>

<form class="form-horizontal" name="newOrderForm" focus-iter="input,textarea,button" novalidate>

    <div class="row">
        <div class="col-sm-10">

            <div class="row" ng-repeat="food in order.foods" ng-form="subForm">
                <div class="form-group"
                     ng-class="{'has-error': isFormInvalid(subForm)}">

                    <label for="inputFood-{{$index}}" class="col-sm-2 control-label">{{$index+1}}. Jídlo</label>

                    <div class="col-sm-8">

                        <input type="text" class="form-control" id="inputFood-{{$index}}" name="inputFood"
                               ng-required="validateInput" ng-change="updateAutocompleter(food.food.Name, $index)"
                               ng-model="food.food.Name" ng-blur="hideAutocompleter()" focus-me/>

                        <ul class="autocomplete" ng-if="showAutocomplete == $index && items.length > 0">
                            <li ng-class="{selected: $index == $selectedItem}" ng-mouseenter="$selectedItem = $index"
                                ng-mouseleave="$selectedItem = -1" ng-repeat="item in items"
                                ng-mousedown="selectFood($index, $parent.$index)">
                                {{item.Number}} - {{item.Name}} <span class="mini">({{item.Nazev}})</span>
                            </li>
                        </ul>

                    </div>

                    <div class="col-sm-2">
                        <input type="number" class="form-control left input-amount" name="inputAmount" id="inputAmount"
                               ng-model="food.amount">
                        <span class="left amount">ks</span>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="row">
        <div class="col-sm-10">
            <div class="row">
                <div class="form-group">

                    <div class="col-sm-offset-2 col-sm-8">

                        <!--<button type="button" class="btn btn-primary" ng-click="newFood($event)">Další jídlo</button>-->

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-10">
            <div class="row">
                <div class="form-group" ng-class="{'has-error': isInvalid('inputStreet')}">
                    <label for="inputStreet" class="col-sm-2 control-label">Ulice</label>

                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="inputStreet" name="inputStreet" placeholder="Ulice"
                               ng-model="order.street" ng-required="validateInput"/>
                    </div>
                    <div class="col-sm-2">
                        <input type="text" class="form-control" id="inputStreetNumber" name="inputStreetNumber"
                               placeholder="č. popisné"
                               ng-model="order.streetNumber"/>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-10">
            <div class="row">
                <div class="form-group" ng-class="{'has-error': isInvalid('inputPhone')}">
                    <label for="inputPhone" class="col-sm-2 control-label">Telefon</label>

                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="inputPhone" name="inputPhone" placeholder="Telefon"
                               ng-model="order.phone" ng-required="validateInput" ng-pattern="phoneNumberPattern"/>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-10">
            <div class="row">
                <div class="form-group">
                    <label for="inputNote" class="col-sm-2 control-label">Poznámka</label>

                    <div class="col-sm-8">
                        <textarea class="form-control" id="inputNote" name="inputNote" placeholder="Poznámka"
                                  ng-model="order.note"></textarea>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-10">
            <div class="row">
                <div class="form-group">

                    <div class="col-sm-offset-2 col-sm-8">

                        <button type="submit" class="btn btn-success">Uložit</button>
                        <button type="button" class="btn btn-danger" ng-click="clear()">Vymazat</button>

                        <div>
                            <input type="checkbox" ng-model="validateInput" id="validateInput"/>
                            <label for="validateInput">Validace vstupních polí</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>

{{order | json}}

<h2>Vyúčtování</h2>

<table class="table">
    <thead>
    <tr>
        <th>Číslo jídla</th>
        <th>Název jídla</th>
        <th>Typ jídla</th>
        <th>Počet ks</th>
        <th>Cena/ks</th>
        <th>Cena celkem</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="item in order.foods | notEmptyFood">
        <td ng-bind="item.food.Number"></td>
        <td ng-bind="item.food.Name"></td>
        <td ng-bind="item.food.Nazev"></td>
        <td ng-bind="item.amount"></td>
        <td ng-bind="item.food.Prize"></td>
        <td ng-bind="totalFoodPrice(item)"></td>
    </tr>
    <tr class="info">
        <td><strong>Cena celkem:</strong></td>
        <td colspan="4"></td>
        <td ng-bind="totalPrice()"></td>
    </tr>
    </tbody>
</table>

